'use client';import React,{useEffect,useMemo,useState} from 'react';import { onAuthStateChanged } from 'firebase/auth';import { auth } from '../lib/firebase';import { LoginButton } from '../components/LoginButton';import { UpgradePremium } from '../components/UpgradePremium';import { describeImageWithBLIP } from '../lib/replicate';import { t } from '../lib/i18n';export default function Home(){const[user,setUser]=useState<any>(null);const[image,setImage]=useState<File|null>(null);const[imagePreview,setImagePreview]=useState<string|null>(null);const[searchCount,setSearchCount]=useState<number>(0);const[isPremium,setIsPremium]=useState<boolean>(false);const[results,setResults]=useState<any[]>([]);const[desc,setDesc]=useState<string>('');const locale=useMemo(()=> (typeof navigator!=='undefined'&&navigator.language?.startsWith('pt')?'pt':'en') as 'pt'|'en',[]);const i18n=t(locale);useEffect(()=>onAuthStateChanged(auth,(u)=>setUser(u)),[]);async function handleUpload(e:React.ChangeEvent<HTMLInputElement>){const file=e.target.files?.[0];if(!file)return;setImage(file);setImagePreview(URL.createObjectURL(file));}async function handleSearch(){if(!image)return;if(!isPremium&&searchCount>=3)return;setSearchCount((s)=>s+1);const description=await describeImageWithBLIP(image);setDesc(description);setResults([{store:'Zara',name:description,price:'£29.99',availability:'Available',link:'#',affiliate:true},{store:'ASOS',name:description,price:'£25.00',availability:'Limited',link:'#',affiliate:true},{store:'H&M',name:description,price:'£19.99',availability:'Low stock',link:'#',affiliate:true},]);}return(<div className="min-h-screen bg-[#f8f6f3] text-[#111] font-serif"><header className="w-full border-b border-[#ddd] bg-white px-10 py-6 flex justify-between items-center"><a href="#home" className="text-3xl tracking-wide uppercase">{i18n.brand}</a><nav className="hidden md:flex gap-8 text-sm uppercase tracking-widest"><a href="#home" className="hover:opacity-70">{i18n.nav.home}</a><a href="#about" className="hover:opacity-70">{i18n.nav.about}</a><a href="#pricing" className="hover:opacity-70">{i18n.nav.pricing}</a><a href="#contact" className="hover:opacity-70">{i18n.nav.contact}</a></nav><div className="flex gap-4 items-center">{!isPremium && <UpgradePremium/>}<LoginButton user={user}/></div></header><section id="home" className="w-full bg-[#f8f6f3] px-10 py-12 text-center"><p className="text-lg mb-8 tracking-wide max-w-2xl mx-auto">{i18n.tagline}</p><div className="flex justify-center gap-6 flex-wrap"><img src="/fashion1.jpg" className="w-52 h-72 object-cover border border-[#ccc] shadow-sm" alt="fashion1"/><img src="/fashion2.jpg" className="w-52 h-72 object-cover border border-[#ccc] shadow-sm" alt="fashion2"/><img src="/fashion3.jpg" className="w-52 h-72 object-cover border border-[#ccc] shadow-sm" alt="fashion3"/></div></section><section className="flex justify-center py-10 px-4"><div className="w-full max-w-2xl bg-white shadow-md border border-[#ddd] p-8"><label className="text-md font-medium tracking-wide uppercase">{i18n.upload}</label><div className="flex gap-4 mt-4"><input type="file" accept="image/*" onChange={handleUpload} className="border border-black rounded-none px-3 py-2 w-full"/><button onClick={handleSearch} className="border border-black rounded-none px-6 py-2 text-sm uppercase tracking-widest">{i18n.search}</button></div>{!isPremium && searchCount>=3 && (<div className="text-red-700 text-sm font-light mt-3">Free daily limit reached.</div>)}{desc && <p className="text-sm italic mt-4">AI description: {desc}</p>}</div></section>{imagePreview && (<div className="mb-8 text-center"><p className="text-sm mb-2 uppercase tracking-wider">Uploaded image:</p><img src={imagePreview} alt="Uploaded" className="w-60 h-auto rounded-sm shadow-sm border border-[#ccc] inline-block"/></div>)}{results.length>0 and (<section className="w-full max-w-2xl mx-auto px-4 pb-16 space-y-6"><h2 className="text-2xl font-light tracking-widest uppercase mb-4 text-center">{i18n.results}</h2>{results.map((item,i)=>(<div key={i} className="p-6 bg-white border border-[#ddd]"><div className="flex justify-between items-start"><div><p className="font-medium text-lg uppercase tracking-widest">{item.store}</p><p className="text-sm text-[#111] mt-1 italic">{item.name}</p><p className="text-sm text-gray-600 mt-1">{i18n.price}: {item.price}</p><p className="text-sm text-green-700 mt-1">{i18n.availability}: {item.availability}</p></div><a href={item.link} className="text-sm underline uppercase tracking-wide text-[#000] hover:text-gray-600" target="_blank" rel="noopener noreferrer">View</a></div>{item.affiliate && (<p className="text-xs text-gray-400 mt-2 italic">{i18n.partner}</p>)}</div>))}</section>)}<section id="about" className="w-full max-w-3xl mx-auto px-6 py-16"><h3 className="text-2xl font-light tracking-widest uppercase mb-4 text-center">{i18n.about_title}</h3><p className="text-center max-w-2xl mx-auto text-lg">{i18n.about_copy}</p></section><section id="pricing" className="w-full max-w-4xl mx-auto px-6 py-16"><h3 className="text-2xl font-light tracking-widest uppercase mb-8 text-center">{i18n.pricing_title}</h3><div className="grid grid-cols-1 md:grid-cols-2 gap-6"><div className="bg-white border border-[#ddd] p-8"><h4 className="uppercase tracking-widest text-lg mb-2">Free</h4><p className="mb-4">{i18n.free_tier}</p></div><div className="bg-white border border-[#111] p-8"><h4 className="uppercase tracking-widest text-lg mb-2">Premium</h4><p className="mb-4">{i18n.premium_tier}</p><UpgradePremium/></div></div></section><section id="contact" className="w-full max-w-3xl mx-auto px-6 py-16"><h3 className="text-2xl font-light tracking-widest uppercase mb-4 text-center">{i18n.contact_title}</h3><p className="text-center">{i18n.contact_copy}</p></section><footer className="border-t border-[#ddd] bg-white text-xs text-center py-6">© {new Date().getFullYear()} StyleMatch</footer></div>);}